/*
    web.json5 - Sample web configuration file

    log and tls can go into ioto.json5
*/
{
    log: {
        path: 'stdout',
        format: '%A: %S: %T: %M',
        types: 'all,error,info,debug,trace',
        sources: 'all,!mbedtls',
        show: 'hH',
    },
    tls: {
        authority: '@certs/roots.crt',
        certificate: 'server.crt',
        ciphers: [
            'TLS_AES_256_GCM_SHA384', 
            'TLS_AES_128_GCM_SHA256',
            'TLS_CHACHA20_POLY1305_SHA256', 
            'TLS_AES_128_CCM_SHA256',
            'TLS_AES_128_CCM_8_SHA256',
            'TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384',
            'TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384',
            'TLS_DHE_RSA_WITH_AES_256_GCM_SHA384',
            'TLS_ECDHE_ECDSA_WITH_AES_256_CCM',
            'TLS_DHE_RSA_WITH_AES_256_CCM',
            'TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384',
            'TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384',
            'TLS_DHE_RSA_WITH_AES_256_CBC_SHA256',
            'TLS_ECDHE_ECDSA_WITH_AES_256_CCM_8',
            'TLS_DHE_RSA_WITH_AES_256_CCM_8',
            'TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256',
            'TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256',
            'TLS_DHE_RSA_WITH_AES_128_GCM_SHA256',
            'TLS_ECDHE_ECDSA_WITH_AES_128_CCM',
            'TLS_DHE_RSA_WITH_AES_128_CCM',
            'TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256',
            'TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256',
            'TLS_DHE_RSA_WITH_AES_128_CBC_SHA256',
            'TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8',
            'TLS_DHE_RSA_WITH_AES_128_CCM_8',
            'TLS_RSA_WITH_AES_256_GCM_SHA384',
            'TLS_RSA_WITH_AES_256_CCM',
            'TLS_RSA_WITH_AES_256_CBC_SHA256',
            'TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384',
            'TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384',
            'TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384',
            'TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384',
            'TLS_RSA_WITH_AES_256_CCM_8',
            'TLS_RSA_WITH_AES_128_GCM_SHA256',
            'TLS_RSA_WITH_AES_128_CCM',
            'TLS_RSA_WITH_AES_128_CBC_SHA256',
            'TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256',
            'TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256',
            'TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256',
            'TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256',
            'TLS_RSA_WITH_AES_128_CCM_8',
        ],
        key: 'server.key',
        verify: {
            client: true,
            issuer: true,
        },
    },
    web: {
        auth: {
            roles: {
                public: [],
                user: [],
                admin: ['user'],
                owner: ['admin'],
                super: ['owner']
            },
            login: '/api/public/login',
            logout: '/api/public/logout',
        },
        documents: './web',
        headers: {
            'Content-Security-Policy': "default-src 'self'",
            'Strict-Transport-Security': 'max-age=31536000; includeSubDomains',
            CrossOrigin: 'origin=* credentials=yes headers=X-CORS-HEADER age=3000',
        },
        index: 'index.html',
        limits: {
            connections: '100',
            header: '10K',
            body: '100K',
            sessions: '20',
            upload: '20MB',
        },
        listen: ['http://:80', 'https://:443'],
        mime: {
            '.avi': 'video/x-msvideo',
            '.bin': 'application/octet-stream',
            '.class': 'application/java',
            '.css': 'text/css',
            '.eps': 'application/postscript',
            '.gif': 'image/gif',
            '.gz': 'application/gzip',
            '.htm': 'text/html',
            '.html': 'text/html',
            '.ico': 'image/vnd.microsoft.icon',
            '.jar': 'application/java',
            '.jpeg': 'image/jpeg',
            '.jpg': 'image/jpeg',
            '.js': 'application/x-javascript',
            '.json': 'application/json',
            '.mov': 'video/quicktime',
            '.mp4': 'video/mp4',
            '.mpeg': 'video/mpeg',
            '.mpg': 'video/mpeg',
            '.patch': 'application/x-patch',
            '.pdf': 'application/pdf',
            '.png': 'image/png',
            '.ps': 'application/postscript',
            '.qt': 'video/quicktime',
            '.rtf': 'application/rtf',
            '.svg': 'image/svg+xml',
            '.tgz': 'application/x-tgz',
            '.tif': 'image/tiff',
            '.tiff': 'image/tiff',
            '.txt': 'text/plain',
            '.wav': 'audio/x-wav',
            '.xml': 'text/xml',
            '.z': 'application/compress',
            '.zip': 'application/zip',
        },
        name: 'example.com',
        redirect: [
            { status: 302, from: "http://:80", to: "https://:443" },
            { status: 302, from: "example.com", to: "new-example.com" },
            { status: 302, from: "http://example.com", to: "https://new-example.com" },
            { status: 302, from: ":443", to: "https://:4443" },
            { status: 301, from: "/old", to: "/new.html" },
            { status: 301, from: '/pressRelease', to: '/fixedPressRelease.html' },
            { status: 302, to: "?redirected" },
        ],
        routes: [
            {match: '/api/', handler: 'action'},
            {match: '/upload/', role: 'user', methods: ['DELETE', 'GET', 'OPTIONS', 'POST', 'PUT']},
            {match: '/admin/', role: 'admin'},
            {match: '/status', stream: true},
            {match: '/unused', redirect: '/auth/login'},
            {},
        ],
        sessions: {
            sameSite: 'Lax',
        },
        timeouts: {
            parse: '10 secs',
            inactivity: '300 secs',
            request: 'infinite',
            session: '30 mins',
        },
        upload: {
            dir: 'tmp',
            remove: true,
        },
    },
}
